<!DOCTYPE html>
<html lang="en">
  <head>
      <!-- Global site tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-125893749-1"></script>
      <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'UA-125893749-1');
          </script>
    <title>autopack :: Kowainik</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Kowainik page">
    <meta name="keywords" content="Haskell, Functional progarmming, FP">
    <meta name="author" content="Kowainik" />

    <!-- Twitter cards -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@kowainik" />
    <meta property="twitter:title" content="Kowainik - autopack" />
    <meta name="twitter:description" content="üì¶ Custom Setup to automate package modules discovery" />
    <meta name="twitter:image:src" content="https://kowainik.github.io/images/logo-yellow.png" />
    <meta property="og:title" content="Kowainik - autopack" />
    <meta property="og:description" content="üì¶ Custom Setup to automate package modules discovery" />
    <meta property="og:site_name" content="Kowainik" />
    <meta property="og:image" content="https://kowainik.github.io/images/logo-yellow.png" />

    <!-- Favicon -->
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/dracula.min.css" />
    <!-- Fontawesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <!-- Custom fonts for this template -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Lato" />
    <!-- Custom styles for this template -->
    <link href="../css/default.css" rel="stylesheet">
    <link href="../css/post.css" rel="stylesheet">
  </head>

  <body class="body-posts">

      <!-- Header -->
      <nav class="navbar navbar-inverse navbar-fixed-left leftmenu bg-primary text-secondary">
            <div class="navbar-header">
                <div class="postslogo"> <a class="navbar-brand" href="../"><img class="img-fluid mb-5 d-block mx-auto" src="../images/logo-tr.png" alt="Kowainik"></a></div>

            </div>
            <div class="coolFont">
                <a class="btn btn-outline-dark btn-tag" href="https://github.com/kowainik/autopack" data-icon="octicon-star" data-size="large" aria-label="Star Kowainik/autopack on GitHub">Star Project</a>
                <a class="fa-stack fa-2x" href="https://github.com/kowainik/autopack/stargazers">
                    <i class="fa fa-star fa-stack-2x"></i>
                    <i id="stars" class="fa fa-stack-1x fa-inverse main-font">23</i>
                </a>
                <div class="author">Language: Haskell</div>

                <div class="allposts">
                    <h3><a href="../projects"> Projects =<< </a></h3>
                </div>
            </div>
      </nav>
      <div class="container info">
          <h2 class="text-center text-uppercase text-secondary">autopack</h2>
          <div class="content">
          <div class="row post">
              <div class="col-12 post-body">
              <p class="lead">
                  <p><img src="https://user-images.githubusercontent.com/4276606/77097260-6bdab780-6a08-11ea-8b86-f8e52f3dbbbc.png" alt="logo" /> <a href="https://github.com/kowainik/autopack/actions"><img src="https://github.com/kowainik/autopack/workflows/CI/badge.svg" alt="GitHub CI" /></a> <a href="https://travis-ci.org/kowainik/autopack"><img src="https://img.shields.io/travis/kowainik/autopack.svg?logo=travis" alt="Build status" /></a> <a href="https://ci.appveyor.com/project/kowainik/autopack"><img src="https://ci.appveyor.com/api/projects/status/github/kowainik/autopack?branch=master&amp;svg=true" alt="Windows build status" /></a></p>
<p><a href="https://hackage.haskell.org/package/autopack"><img src="https://img.shields.io/hackage/v/autopack.svg?logo=haskell" alt="Hackage" /></a> <a href="http://stackage.org/lts/package/autopack"><img src="http://stackage.org/package/autopack/badge/lts" alt="Stackage Lts" /></a> <a href="http://stackage.org/nightly/package/autopack"><img src="http://stackage.org/package/autopack/badge/nightly" alt="Stackage Nightly" /></a> <a href="LICENSE"><img src="https://img.shields.io/badge/license-MPL--2.0-blue.svg" alt="MPL-2.0 license" /></a></p>
<p>Custom Setup to automate package modules discovery.</p>
<p>‚ö†Ô∏è <strong>WARNING:</strong> <code>autopack</code> is in early beta phase. ‚ö†Ô∏è</p>
<h2 id="motivation">Motivation<a href="#motivation" class="anchor">üîó</a></h2>
<p>Usually, when working on a Haskell project, you end up having lots of modules. During the development, you can add, remove or rename any of them. And this is fine unless you continuously need remembering to add, remove or rename the corresponding module line in the <code>.cabal</code> file. Sometimes all you want is to make <code>Cabal</code> dealing with it, so you won‚Äôt need to patch any files when performing any operations on modules. Good news, everyone! This project was created precisely to help to solve this particular issue.</p>
<h2 id="how-does-autopack-work">How does <code>autopack</code> work<a href="#how-does-autopack-work" class="anchor">üîó</a></h2>
<p><code>autopack</code> is a Haskell library that provides custom setup functions that discover all exposed <code>.hs</code> files for your library from the <code>hs-source-dirs</code> folders. It uses this information to prehook the list of identified modules into the <code>exposed-modules</code> field of the library stanza of your package description.</p>
<p>You can use <a href="https://www.haskell.org/cabal/users-guide/developing-packages.html#custom-setup-scripts">Cabal‚Äôs custom setup scripts</a> to use this library in your project. In the next section, we are going to give detailed instructions on that.</p>
<p>For now, all you need to keep in mind to use <code>autopack</code>:</p>
<ul>
<li>It uses <a href="https://www.haskell.org/cabal/users-guide/developing-packages.html#pkg-field-hs-source-dirs"><code>hs-source-dirs</code></a> field to establish where to look up for modules.</li>
<li>It can work only with <code>.hs</code> and <code>.hsc</code> extensions at the moment.</li>
<li>It adds all discovered modules into <a href="https://www.haskell.org/cabal/users-guide/developing-packages.html#pkg-field-library-exposed-modules"><code>exposed-modules</code></a> of the library stanza.</li>
<li>If there are already some modules in the <code>exposed-modules</code>, <code>autopack</code> will concatenate lists.</li>
</ul>
<h2 id="how-to-use-autopack">How to use <code>autopack</code><a href="#how-to-use-autopack" class="anchor">üîó</a></h2>
<p>First, make sure that you are using the Cabal version at least <code>2.0</code> in your <code>.cabal</code> file. For example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>cabal<span class="op">-</span>version<span class="op">:</span>       <span class="fl">2.4</span></span></code></pre></div>
<p>Now you need to change the <a href="https://www.haskell.org/cabal/users-guide/developing-packages.html#pkg-field-build-type"><code>build-type</code></a> field in your <code>package_name.cabal</code> file to <code>Custom</code> instead of the default <code>Simple</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>build<span class="op">-</span><span class="kw">type</span><span class="op">:</span>    <span class="dt">Custom</span></span></code></pre></div>
<p>Then you have to add <code>custom-setup</code> section before you defining your library stanza. It should have the <code>autopack</code> dependency so you can use it in your <code>Setup</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a>custom<span class="op">-</span>setup</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>    setup<span class="op">-</span>depends<span class="op">:</span> base</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>                 , autopack</span></code></pre></div>
<p>And the final preparation. You should add the <code>Setup.hs</code> module (or replace the default one) in the root directory of the package with the following content:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="kw">import</span> <span class="dt">Autopack</span> (defaultMainAutoModules)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="ot">main ::</span> <span class="dt">IO</span> ()</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a>main <span class="ot">=</span> defaultMainAutoModules</span></code></pre></div>
<p>You are all set up now!</p>
<p>You can remove <code>exposed-module</code> field from your <code>.cabal</code> file completely, and <code>autopack</code> will discover all the <code>.hs</code> modules in your folders for you during the build.</p>
<h2 id="alternatives">Alternatives<a href="#alternatives" class="anchor">üîó</a></h2>
<p>As <code>Cabal</code> does not currently provide the feature of automatic modules discovery, there are some workarounds for this process. One of them is this library ‚Äî <code>autopack</code> that uses <code>Cabal</code>‚Äôs Setup feature to discover all modules during the pre-build stage of <code>Cabal</code>. Another tool that provides it out-of-the-box is <a href="https://github.com/sol/hpack"><code>hpack</code></a>. It is the wrapper on <code>Cabal</code> syntax via <code>YAML</code> where there is no need to write modules explicitly. They are added to the <code>exposed-modules</code> field of the <code>.cabal</code> file during the YAML to <code>.cabal</code> step of the tool work process. You may also be interested in <a href="https://hackage.haskell.org/package/cabal-fmt"><code>cabal-fmt</code></a> ‚Äì a non-official <code>.cabal</code> files formatter than can optionally expand source directories during formatting.</p>
<h2 id="acknowledgement">Acknowledgement<a href="#acknowledgement" class="anchor">üîó</a></h2>
<p>Icons made by <a href="http://www.freepik.com">Freepik</a> from <a href="https://www.flaticon.com/">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/">CC 3.0 BY</a>.</p>
              </p>
              </div>
          </div>
          </div>


      </div>

      <script src="../js/stars.js"></script>
      <script>
       shootingStars("kowainik/autopack", function (stars) {
           document.getElementById("stars").innerHTML = stars;
       });
      </script>


      <!-- Bootstrap core JavaScript -->
      <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"> </script>
      <script src="../js/post.js"> </script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/haskell.min.js"></script>
      <script>hljs.initHighlightingOnLoad()</script>
      <script async defer src="https://buttons.github.io/buttons.js"></script>
  </body>
</html>
