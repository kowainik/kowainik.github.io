<!DOCTYPE html>
<html lang="en">
  <head>
      <!-- Global site tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-125893749-1"></script>
      <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'UA-125893749-1');
          </script>
    <title>Haskell Style Guide</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Kowainik page">
    <meta name="keywords" content="Haskell, Functional progarmming, FP">
    <meta name="author" content="Kowainik" />

    <!-- Twitter cards -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@kowainik" />
    <meta property="twitter:title" content="Kowainik - Haskell Style Guide" />
    <meta name="twitter:description" content="Haskell Style guide used in Kowainik" />
    <meta name="twitter:image:src" content="https://kowainik.github.io/images/logo-yellow.png" />
    <meta property="og:title" content="Kowainik - Haskell Style Guide" />
    <meta property="og:description" content="Haskell Style guide used in Kowainik" />
    <meta property="og:site_name" content="Kowainik" />
    <meta property="og:image" content="https://kowainik.github.io/images/logo-yellow.png" />

    <!-- Favicon -->
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/dracula.min.css" />
    <!-- Custom fonts for this template -->
    <link href="../css/font-awesome.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">

    <!-- Custom styles for this template -->
    <link href="../css/default.css" rel="stylesheet">
    <link href="../css/post.css" rel="stylesheet">
  </head>

  <body class="body-posts">

          <!-- Header -->
      <nav class="navbar navbar-inverse navbar-fixed-left leftmenu bg-primary text-secondary">
            <div class="navbar-header">
                <div class="postslogo"> <a class="navbar-brand" href="../"><img class="img-fluid" src="../images/logo-tr.png" alt="Kowainik"></a></div>
            </div>
            <div class="toc-zone">
                <h6 class="coolFont">Contents</h6>
                <div class="toc" id="main">
                    <ul>
<li><a href="#style-guide-goals">Style guide goals</a></li>
<li><a href="#rule-of-thumb-when-working-with-existing-source-code">Rule of thumb when working with existing source code</a></li>
<li><a href="#indentation">Indentation</a></li>
<li><a href="#line-length">Line length</a></li>
<li><a href="#whitespaces">Whitespaces</a></li>
<li><a href="#alignment">Alignment</a></li>
<li><a href="#naming">Naming</a><ul>
<li><a href="#functions-and-variables">Functions and variables</a></li>
<li><a href="#data-types">Data types</a></li>
</ul></li>
<li><a href="#comments">Comments</a></li>
<li><a href="#guideline-for-module-formatting">Guideline for module formatting</a><ul>
<li><a href="#language--">{-# LANGUAGE #-}</a></li>
<li><a href="#export-lists">Export lists</a></li>
<li><a href="#imports">Imports</a></li>
<li><a href="#data-declaration">Data declaration</a></li>
<li><a href="#strictness">Strictness</a></li>
<li><a href="#deriving">Deriving</a></li>
<li><a href="#function-declaration">Function declaration</a></li>
<li><a href="#if-then-else-clauses">if-then-else clauses</a></li>
<li><a href="#case-expressions">Case expressions</a></li>
<li><a href="#let-expressions">let expressions</a></li>
</ul></li>
<li><a href="#general-recommendations">General recommendations</a></li>
</ul>
                </div>
            </div>
            <div class="coolFont">
                <div>Date: February  6, 2019</div>

                <div class="author">Author: Kowainik</div>
                <div class="row tag-block">
                
                <span class="tag-block"> <a class="btn btn-outline-dark btn-tag" href="../tags/haskell">haskell</a></span>
                
                <span class="tag-block"> <a class="btn btn-outline-dark btn-tag" href="../tags/guide">guide</a></span>
                
                </div>

                <div class="allposts">
                    <h3><a href="../posts"> Posts =<< </a></h3>
                </div>
            </div>
      </nav>
      <div class="container info">
          <h2 class="text-center text-uppercase text-secondary">Haskell Style Guide</h2>
          <div class="content">
          <div class="row post">
              <div class="col-12 post-body">
              <p class="lead">
                  <blockquote>
<p>Style guide used in Kowainik.</p>
</blockquote>
<p>This document is a collection of best-practices inspired by commercial and free open source Haskell libraries and applications.</p>
<h2 id="style-guide-goals">Style guide goals<a href="#style-guide-goals" class="anchor">ðŸ”—</a></h2>
<p>The purpose of this document is to help developers and people working on Haskell code-bases to have a smoother experience while dealing with code in different situations. This style guide aims to increase productivity by defining the following goals:</p>
<ol type="1">
<li>Make code <strong>easier to understand:</strong> ideas for solutions should not be hidden behind complex and obscure code.</li>
<li>Make code <strong>easier to read:</strong> code arrangement should be immediately apparent after looking at the existing code. Names of functions &amp; variables should be transparent and obvious.</li>
<li>Make code <strong>easier to write:</strong> developers should think about code formatting rules as little as possible. The style guide should answer any query pertaining to the formatting of a specific piece of code.</li>
<li>Make code <strong>easier to maintain:</strong> this style guide aims to reduce the burden of maintaining packages using version control systems unless this conflicts with the previous points.</li>
</ol>
<h2 id="rule-of-thumb-when-working-with-existing-source-code">Rule of thumb when working with existing source code<a href="#rule-of-thumb-when-working-with-existing-source-code" class="anchor">ðŸ”—</a></h2>
<p>The general rule is to stick to the same coding style that is already used in the file you are editing. If you must make significant style modifications, then commit them independently from the functional changes so that someone looking back through the changelog can easily distinguish between them.</p>
<h2 id="indentation">Indentation<a href="#indentation" class="anchor">ðŸ”—</a></h2>
<p>Indent code blocks with <em>4 spaces</em>.</p>
<p>Indent <code>where</code> keywords with <em>2 spaces</em> and always put a <code>where</code> keyword on a new line.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1"></a><span class="ot">showSign ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">String</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>showSign n</span>
<span id="cb1-3"><a href="#cb1-3"></a>    <span class="op">|</span> n <span class="op">==</span> <span class="dv">0</span>    <span class="ot">=</span> <span class="st">&quot;Zero&quot;</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>    <span class="op">|</span> n <span class="op">&lt;</span> <span class="dv">0</span>     <span class="ot">=</span> <span class="st">&quot;Negative&quot;</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>    <span class="op">|</span> <span class="fu">otherwise</span> <span class="ot">=</span> <span class="st">&quot;Positive&quot;</span></span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="ot">greet ::</span> <span class="dt">IO</span> ()</span>
<span id="cb1-8"><a href="#cb1-8"></a>greet <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;What is your name?&quot;</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>    name <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>    <span class="fu">putStrLn</span> <span class="op">$</span> greeting name</span>
<span id="cb1-12"><a href="#cb1-12"></a>  <span class="kw">where</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="ot">    greeting ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>    greeting name <span class="ot">=</span> <span class="st">&quot;Hey &quot;</span> <span class="op">++</span> name <span class="op">++</span> <span class="st">&quot;!&quot;</span></span></code></pre></div>
<h2 id="line-length">Line length<a href="#line-length" class="anchor">ðŸ”—</a></h2>
<p>The maximum allowed line length is <em>90 characters</em>. If your line of code exceeds this limit, try to split code into smaller chunks or break long lines over multiple shorter ones.</p>
<h2 id="whitespaces">Whitespaces<a href="#whitespaces" class="anchor">ðŸ”—</a></h2>
<p><strong>No trailing whitespaces</strong> (use some tools to automatically cleanup trailing whitespaces).</p>
<p>Surround binary operators with a single space on either side.</p>
<h2 id="alignment">Alignment<a href="#alignment" class="anchor">ðŸ”—</a></h2>
<p>Use <em>comma-leading</em> style for formatting module exports, lists, tuples, records, etc.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb2-1"><a href="#cb2-1"></a><span class="ot">answers ::</span> [<span class="dt">Maybe</span> <span class="dt">Int</span>]</span>
<span id="cb2-2"><a href="#cb2-2"></a>answers <span class="ot">=</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>    [ <span class="dt">Just</span> <span class="dv">42</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>    , <span class="dt">Just</span> <span class="dv">7</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>    , <span class="dt">Nothing</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>    ]</span></code></pre></div>
<p>If a function definition doesnâ€™t fit the line limit then align multiple lines according to the same separator like <code>::</code>, <code>=&gt;</code>, <code>-&gt;</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb3-1"><a href="#cb3-1"></a>printQuestion</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="ot">    ::</span> <span class="dt">Show</span> a</span>
<span id="cb3-3"><a href="#cb3-3"></a>    <span class="ot">=&gt;</span> <span class="dt">Text</span>  <span class="co">-- ^ Question text</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>    <span class="ot">-&gt;</span> [a]   <span class="co">-- ^ List of available answers</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>    <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</span></code></pre></div>
<p>Align records with every field on a separate line with leading commas.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">data</span> <span class="dt">Foo</span> <span class="ot">=</span> <span class="dt">Foo</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>    {<span class="ot"> fooBar  ::</span> <span class="dt">Bar</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>    ,<span class="ot"> fooBaz  ::</span> <span class="dt">Baz</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>    ,<span class="ot"> fooQuux ::</span> <span class="dt">Quux</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>    } <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>, <span class="dt">Generic</span>)</span>
<span id="cb4-6"><a href="#cb4-6"></a>      <span class="kw">deriving</span> anyclass (<span class="dt">FromJSON</span>, <span class="dt">ToJSON</span>)</span></code></pre></div>
<p>Align sum types with every constructor on its own line with leading <code>=</code> and <code>|</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">data</span> <span class="dt">TrafficLight</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="ot">=</span> <span class="dt">Red</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="op">|</span> <span class="dt">Yellow</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>    <span class="op">|</span> <span class="dt">Green</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>    <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Ord</span>, <span class="dt">Enum</span>, <span class="dt">Bounded</span>, <span class="dt">Show</span>, <span class="dt">Read</span>)</span></code></pre></div>
<ul>
<li><strong>The indentation of a line should not depend on the length of any identifier in preceding lines.</strong></li>
</ul>
<p>Try to follow the above rule inside function definitions but without fanatism:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">-- + Good</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>createFoo <span class="ot">=</span> <span class="dt">Foo</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>    <span class="op">&lt;$&gt;</span> veryLongBar</span>
<span id="cb6-4"><a href="#cb6-4"></a>    <span class="op">&lt;*&gt;</span> veryLongBaz</span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">-- - Bad</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>createFoo <span class="ot">=</span> <span class="dt">Foo</span> <span class="op">&lt;$&gt;</span> veryLongBar</span>
<span id="cb6-8"><a href="#cb6-8"></a>                <span class="op">&lt;*&gt;</span> veryLongBaz</span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">-- - Meh</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>createFoo <span class="ot">=</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>    <span class="dt">Foo</span>  <span class="co">-- there's no need to put the constructor on a separate line and have an extra line</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>    <span class="op">&lt;$&gt;</span> veryLongBar</span>
<span id="cb6-14"><a href="#cb6-14"></a>    <span class="op">&lt;*&gt;</span> veryLongBaz</span></code></pre></div>
<p>Basically, it is often possible to join consequent lines without introducing alignment dependency. Try not to span multiple short lines unnecessarily.</p>
<p>If a function application must spawn multiple lines to fit within the maximum line length, then write one argument on each line following the head, indented by one level:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb7-1"><a href="#cb7-1"></a>veryLongProductionName</span>
<span id="cb7-2"><a href="#cb7-2"></a>    firstArgumentOfThisFunction</span>
<span id="cb7-3"><a href="#cb7-3"></a>    secondArgumentOfThisFunction</span>
<span id="cb7-4"><a href="#cb7-4"></a>    (<span class="dt">DummyDatatype</span> withDummyField1 andDummyField2)</span>
<span id="cb7-5"><a href="#cb7-5"></a>    lastArgumentOfThisFunction</span></code></pre></div>
<h2 id="naming">Naming<a href="#naming" class="anchor">ðŸ”—</a></h2>
<h3 id="functions-and-variables">Functions and variables<a href="#functions-and-variables" class="anchor">ðŸ”—</a></h3>
<ul>
<li><strong>lowerCamelCase</strong> for function and variable names.</li>
<li><strong>UpperCamelCase</strong> for data types, typeclasses and constructors.</li>
</ul>
<p>Try not to create new operators.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb8-1"><a href="#cb8-1"></a><span class="co">-- What does this 'mouse operator' mean? :thinking_suicide:</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="ot">(~@@^&gt;) ::</span> <span class="dt">Functor</span> f <span class="ot">=&gt;</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> (a <span class="ot">-&gt;</span> c <span class="ot">-&gt;</span> d) <span class="ot">-&gt;</span> (b <span class="ot">-&gt;</span> f c) <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> f d</span></code></pre></div>
<p>Do not use ultra-short or indescriptive names like <code>a</code>, <code>par</code>, <code>g</code> unless the types of these variables are general enough.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">-- + Good</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="ot">mapSelect ::</span> <span class="kw">forall</span> a <span class="op">.</span> (a <span class="ot">-&gt;</span> <span class="dt">Bool</span>) <span class="ot">-&gt;</span> (a <span class="ot">-&gt;</span> a) <span class="ot">-&gt;</span> (a <span class="ot">-&gt;</span> a) <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> [a]</span>
<span id="cb9-3"><a href="#cb9-3"></a>mapSelect test ifTrue ifFalse <span class="ot">=</span> go</span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="kw">where</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="ot">    go ::</span> [a] <span class="ot">-&gt;</span> [a]</span>
<span id="cb9-6"><a href="#cb9-6"></a>    go [] <span class="ot">=</span> []</span>
<span id="cb9-7"><a href="#cb9-7"></a>    go (x<span class="op">:</span>xs) <span class="ot">=</span> <span class="kw">if</span> test x</span>
<span id="cb9-8"><a href="#cb9-8"></a>        <span class="kw">then</span> ifTrue  x <span class="op">:</span> go xs</span>
<span id="cb9-9"><a href="#cb9-9"></a>        <span class="kw">else</span> ifFalse x <span class="op">:</span> go xs</span>
<span id="cb9-10"><a href="#cb9-10"></a></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">-- - Bad</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="ot">mapSelect ::</span> <span class="kw">forall</span> a <span class="op">.</span> (a <span class="ot">-&gt;</span> <span class="dt">Bool</span>) <span class="ot">-&gt;</span> (a <span class="ot">-&gt;</span> a) <span class="ot">-&gt;</span> (a <span class="ot">-&gt;</span> a) <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> [a]</span>
<span id="cb9-13"><a href="#cb9-13"></a>mapSelect p f g <span class="ot">=</span> go</span>
<span id="cb9-14"><a href="#cb9-14"></a>  <span class="kw">where</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="ot">    go ::</span> [a] <span class="ot">-&gt;</span> [a]</span>
<span id="cb9-16"><a href="#cb9-16"></a>    go [] <span class="ot">=</span> []</span>
<span id="cb9-17"><a href="#cb9-17"></a>    go (x<span class="op">:</span>xs) <span class="ot">=</span> <span class="kw">if</span> p x</span>
<span id="cb9-18"><a href="#cb9-18"></a>        <span class="kw">then</span> f x <span class="op">:</span> go xs</span>
<span id="cb9-19"><a href="#cb9-19"></a>        <span class="kw">else</span> g x <span class="op">:</span> go xs</span></code></pre></div>
<p>Do not introduce unnecessarily long names for variables.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">-- + Good</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">map</span><span class="ot"> ::</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> [b]</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="fu">map</span> _ []     <span class="ot">=</span> []</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="fu">map</span> f (x<span class="op">:</span>xs) <span class="ot">=</span> f x <span class="op">:</span> <span class="fu">map</span> f xs</span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">-- - Bad</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="fu">map</span><span class="ot"> ::</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> [b]</span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="fu">map</span> _ [] <span class="ot">=</span> []</span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="fu">map</span> function (firstElement<span class="op">:</span>remainingList) <span class="ot">=</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>    function firstElement <span class="op">:</span> <span class="fu">map</span> function remainingList</span></code></pre></div>
<p>For readability reasons, do not capitalize all letters when using an abbreviation as a part of a longer name. For example, write <code>TomlException</code> instead of <code>TOMLException</code>.</p>
<p>Unicode symbols are allowed only in modules that already use unicode symbols. If you create a unicode name, you should also create a non-unicode one as an alias.</p>
<h3 id="data-types">Data types<a href="#data-types" class="anchor">ðŸ”—</a></h3>
<p>Creating data types is extremely easy in Haskell. It is usually a good idea to introduce a custom data type (enum or <code>newtype</code>) instead of using a commonly used data type (like <code>Int</code>, <code>String</code>, <code>Set Text</code>, etc.).</p>
<p><code>type</code> aliases are allowed only for specializing general types:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">-- + Good</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw">data</span> <span class="dt">StateT</span> s m a</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw">type</span> <span class="dt">State</span> s <span class="ot">=</span> <span class="dt">StateT</span> s <span class="dt">Identity</span></span>
<span id="cb11-4"><a href="#cb11-4"></a></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">-- - Bad</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="kw">type</span> <span class="dt">Size</span> <span class="ot">=</span> <span class="dt">Int</span></span></code></pre></div>
<p>Use the data type name as the constructor name for <code>data</code> with single constructor and <code>newtype</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">data</span> <span class="dt">User</span> <span class="ot">=</span> <span class="dt">User</span> <span class="dt">Int</span> <span class="dt">String</span></span></code></pre></div>
<p>The field name for a <code>newtype</code> must be prefixed by <code>un</code> followed by the type name.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">newtype</span> <span class="dt">Size</span> <span class="ot">=</span> <span class="dt">Size</span> {<span class="ot"> unSize ::</span> <span class="dt">Int</span> }</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">newtype</span> <span class="dt">App</span> a <span class="ot">=</span> <span class="dt">App</span> {<span class="ot"> unApp ::</span> <span class="dt">ReaderT</span> <span class="dt">Context</span> <span class="dt">IO</span> a }</span></code></pre></div>
<p>Field names for the record data type should start with the full name of the data type.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb14-1"><a href="#cb14-1"></a><span class="co">-- + Good</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw">data</span> <span class="dt">HealthReading</span> <span class="ot">=</span> <span class="dt">HealthReading</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>    {<span class="ot"> healthReadingDate        ::</span> <span class="dt">UTCTime</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>    ,<span class="ot"> healthReadingMeasurement ::</span> <span class="dt">Double</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>    }</span></code></pre></div>
<p>It is acceptable to use an abbreviation as the field prefix if the data type name is too long.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb15-1"><a href="#cb15-1"></a><span class="co">-- + Acceptable</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">data</span> <span class="dt">HealthReading</span> <span class="ot">=</span> <span class="dt">HealthReading</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>    {<span class="ot"> hrDate        ::</span> <span class="dt">UTCTime</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>    ,<span class="ot"> hrMeasurement ::</span> <span class="dt">Double</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>    }</span></code></pre></div>
<h2 id="comments">Comments<a href="#comments" class="anchor">ðŸ”—</a></h2>
<p>Separate end-of-line comments from the code with <em>2 spaces</em>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">newtype</span> <span class="dt">Measure</span> <span class="ot">=</span> <span class="dt">Measure</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>    {<span class="ot"> unMeasure ::</span> <span class="dt">Double</span>  <span class="co">-- ^ See how 2 spaces separate this comment</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>    }</span></code></pre></div>
<p>Write <a href="https://github.com/aisamanra/haddock-cheatsheet/blob/master/haddocks.pdf">Haddock documentation</a> for the top-level functions, function arguments and data type fields. The documentation should give enough information to apply the function without looking at its definition.</p>
<p>Use block comment style (<code>{- |</code> and <code>-}</code>) for Haddock for multiple line comments.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">-- + Good</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">{- | Example of multi-line block comment which is very long</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co">and doesn't fit single line.</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">-}</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="ot">foo ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> [a]</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co">-- + Also good</span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co">-- | Single-line short comment.</span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="ot">foo ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> [a]</span>
<span id="cb17-10"><a href="#cb17-10"></a></span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="co">-- ~ Bad</span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="co">-- | Example of multi-line block comment which is very long</span></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="co">-- and doesn't fit single line.</span></span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="ot">foo ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> [a]</span></code></pre></div>
<p>For commenting function arguments, data type constructors and their fields, you are allowed to use end-of-line Haddock comments if they fit line length limit. Otherwise, use block style comments. It is <em>allowed</em> to align end-of-line comments with each other. But it is <em>forbidden</em> to use comments of different styles for the function arguments, data type constructors, and fields.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb18-1"><a href="#cb18-1"></a><span class="co">-- + Good</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co">{- | 'replicate' @n x@ returns list of length @n@ with @x@ as the value of</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">every element. This function is lazy in its returned value.</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">-}</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="fu">replicate</span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="ot">    ::</span> <span class="dt">Int</span>  <span class="co">-- ^ Length of returned list</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>    <span class="ot">-&gt;</span> a    <span class="co">-- ^ Element to populate list</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>    <span class="ot">-&gt;</span> [a]</span>
<span id="cb18-9"><a href="#cb18-9"></a></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co">-- - Bad</span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co">{- | 'replicate' @n x@ returns list of length @n@ with @x@ as the value of</span></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="co">every element. This function is lazy in its returned value.</span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co">-}</span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="fu">replicate</span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="ot">    ::</span> <span class="dt">Int</span>  <span class="co">-- ^ Length of returned list</span></span>
<span id="cb18-16"><a href="#cb18-16"></a>    <span class="co">{- | Element to populate list -}</span></span>
<span id="cb18-17"><a href="#cb18-17"></a>    <span class="ot">-&gt;</span> a</span>
<span id="cb18-18"><a href="#cb18-18"></a>    <span class="ot">-&gt;</span> [a]</span></code></pre></div>
<p>If possible, include typeclass laws and function usage examples into the documentation.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb19-1"><a href="#cb19-1"></a><span class="co">{- | The class of semigroups (types with an associative binary operation).</span></span>
<span id="cb19-2"><a href="#cb19-2"></a></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">Instances should satisfy the associativity law:</span></span>
<span id="cb19-4"><a href="#cb19-4"></a></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co">* @x '&lt;&gt;' (y '&lt;&gt;' z) = (x '&lt;&gt;' y) '&lt;&gt;' z@</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co">-}</span></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="kw">class</span> <span class="dt">Semigroup</span> a <span class="kw">where</span></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="ot">    (&lt;&gt;) ::</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a</span>
<span id="cb19-9"><a href="#cb19-9"></a></span>
<span id="cb19-10"><a href="#cb19-10"></a></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="co">{- | The 'intersperse' function takes a character and places it</span></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="co">between the characters of a 'Text'.</span></span>
<span id="cb19-13"><a href="#cb19-13"></a></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="co">&gt;&gt;&gt; T.intersperse '.' &quot;SHIELD&quot;</span></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co">&quot;S.H.I.E.L.D&quot;</span></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="co">-}</span></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="ot">intersperse ::</span> <span class="dt">Char</span> <span class="ot">-&gt;</span> <span class="dt">Text</span> <span class="ot">-&gt;</span> <span class="dt">Text</span></span></code></pre></div>
<h2 id="guideline-for-module-formatting">Guideline for module formatting<a href="#guideline-for-module-formatting" class="anchor">ðŸ”—</a></h2>
<p>Allowed tools for automatic module formatting:</p>
<ul>
<li><a href="https://github.com/jaspervdj/stylish-haskell"><code>stylish-haskell</code></a> (with a relevant <a href="https://github.com/kowainik/org/blob/master/.stylish-haskell.yaml"><code>.stylish-haskell.yaml</code></a>): for formatting the import section and for alignment.</li>
<li><a href="https://github.com/kowainik/smuggler"><code>smuggler</code></a>: for removing unused imports.</li>
</ul>
<h3 id="language--">{-# LANGUAGE #-}<a href="#language--" class="anchor">ðŸ”—</a></h3>
<p>Put <code>OPTIONS_GHC</code> pragma before <code>LANGUAGE</code> pragmas in a separate section. Write each <code>LANGUAGE</code> pragma on its own line, sort them alphabetically and align by max width among them.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb20-1"><a href="#cb20-1"></a><span class="ot">{-# OPTIONS_GHC -fno-warn-orphans #-}</span></span>
<span id="cb20-2"><a href="#cb20-2"></a></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="ot">{-# LANGUAGE ApplicativeDo       #-}</span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="ot">{-# LANGUAGE ScopedTypeVariables #-}</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="ot">{-# LANGUAGE TypeApplications    #-}</span></span></code></pre></div>
<p>You can put commonly-used language extensions into <code>default-extensions</code> in the <code>.cabal</code> file. Here is the list of extensions this style guide allows one to put in there:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb21-1"><a href="#cb21-1"></a><span class="dt">ConstraintKinds</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="dt">DeriveGeneric</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="dt">GeneralizedNewtypeDeriving</span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="dt">InstanceSigs</span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="dt">KindSignatures</span></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="dt">LambdaCase</span></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="dt">OverloadedStrings</span></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="dt">RecordWildCards</span></span>
<span id="cb21-9"><a href="#cb21-9"></a><span class="dt">ScopedTypeVariables</span></span>
<span id="cb21-10"><a href="#cb21-10"></a><span class="dt">StandaloneDeriving</span></span>
<span id="cb21-11"><a href="#cb21-11"></a><span class="dt">TupleSections</span></span>
<span id="cb21-12"><a href="#cb21-12"></a><span class="dt">TypeApplications</span></span>
<span id="cb21-13"><a href="#cb21-13"></a><span class="dt">ViewPatterns</span></span></code></pre></div>
<h3 id="export-lists">Export lists<a href="#export-lists" class="anchor">ðŸ”—</a></h3>
<p>Use the following rules to format the export section:</p>
<ol type="1">
<li><strong>Always write</strong> an explicit export list.</li>
<li>Indent the export list by <em>7 spaces</em> (so that the bracket is below the first letter of the module name).</li>
<li>You can split the export list into sections. Use Haddock to assign names to these sections.</li>
<li>Classes, data types and type aliases should be written before functions in each section.</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">module</span> <span class="dt">Map</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>       ( <span class="co">-- * Data type</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>         <span class="dt">Map</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>       , <span class="dt">Key</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>       , empty</span>
<span id="cb22-6"><a href="#cb22-6"></a></span>
<span id="cb22-7"><a href="#cb22-7"></a>         <span class="co">-- * Update</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>       , insert</span>
<span id="cb22-9"><a href="#cb22-9"></a>       , insertWith</span>
<span id="cb22-10"><a href="#cb22-10"></a>       , alter</span>
<span id="cb22-11"><a href="#cb22-11"></a>       ) <span class="kw">where</span></span></code></pre></div>
<h3 id="imports">Imports<a href="#imports" class="anchor">ðŸ”—</a></h3>
<p>Always use explicit import lists or qualified imports. Use qualified imports only if the import list is big enough or there are conflicts in names. This makes the code more robust against changes in dependent libraries.</p>
<ul>
<li><strong>Exception:</strong> modules that only reexport other entire modules.</li>
</ul>
<p>Imports should be grouped in the following order:</p>
<ol type="1">
<li>Non-qualified imports from Hackage packages.</li>
<li>Non-qualified imports from the current project.</li>
<li>Qualified imports from Hackage packages.</li>
<li>Qualified imports from the current project.</li>
</ol>
<p>Put a blank line between each group of imports.</p>
<p>Put <em>2 blank lines</em> after the import section.</p>
<p>The imports in each group should be sorted alphabetically by module name.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">module</span> <span class="dt">MyProject.Foo</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>       ( <span class="dt">Foo</span> (<span class="op">..</span>)</span>
<span id="cb23-3"><a href="#cb23-3"></a>       ) <span class="kw">where</span></span>
<span id="cb23-4"><a href="#cb23-4"></a></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="kw">import</span> <span class="dt">Control.Exception</span> (catch, try)</span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="kw">import</span> <span class="dt">Data.Traversable</span> (for)</span>
<span id="cb23-7"><a href="#cb23-7"></a></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="kw">import</span> <span class="dt">MyProject.Ansi</span> (errorMessage, infoMessage)</span>
<span id="cb23-9"><a href="#cb23-9"></a></span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Aeson</span> <span class="kw">as</span> <span class="dt">Json</span></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Text</span> <span class="kw">as</span> <span class="dt">Text</span></span>
<span id="cb23-12"><a href="#cb23-12"></a></span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">MyProject.BigModule</span> <span class="kw">as</span> <span class="dt">Big</span></span>
<span id="cb23-14"><a href="#cb23-14"></a></span>
<span id="cb23-15"><a href="#cb23-15"></a></span>
<span id="cb23-16"><a href="#cb23-16"></a><span class="kw">data</span> <span class="dt">Foo</span></span>
<span id="cb23-17"><a href="#cb23-17"></a><span class="op">...</span></span></code></pre></div>
<h3 id="data-declaration">Data declaration<a href="#data-declaration" class="anchor">ðŸ”—</a></h3>
<p>Refer to the <a href="#alignment">Alignment section</a> to see how to format data type declarations.</p>
<p>Records for data types with multiple constructors are forbidden.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb24-1"><a href="#cb24-1"></a><span class="co">-- - Bad</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="kw">data</span> <span class="dt">Foo</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>    <span class="ot">=</span> <span class="dt">Bar</span> {<span class="ot"> bar1 ::</span> <span class="dt">Int</span>,<span class="ot"> bar2 ::</span> <span class="dt">Double</span> }</span>
<span id="cb24-4"><a href="#cb24-4"></a>    <span class="op">|</span> <span class="dt">Baz</span> {<span class="ot"> baz1 ::</span> <span class="dt">Int</span>,<span class="ot"> baz2 ::</span> <span class="dt">Double</span>,<span class="ot"> baz3 ::</span> <span class="dt">Text</span> }</span>
<span id="cb24-5"><a href="#cb24-5"></a></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="co">-- + Good</span></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="kw">data</span> <span class="dt">Foo</span></span>
<span id="cb24-8"><a href="#cb24-8"></a>    <span class="ot">=</span> <span class="dt">FooBar</span> <span class="dt">Bar</span></span>
<span id="cb24-9"><a href="#cb24-9"></a>    <span class="op">|</span> <span class="dt">FooBaz</span> <span class="dt">Baz</span></span>
<span id="cb24-10"><a href="#cb24-10"></a></span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="kw">data</span> <span class="dt">Bar</span> <span class="ot">=</span> <span class="dt">Bar</span> {<span class="ot"> bar1 ::</span> <span class="dt">Int</span>,<span class="ot"> bar2 ::</span> <span class="dt">Double</span> }</span>
<span id="cb24-12"><a href="#cb24-12"></a><span class="kw">data</span> <span class="dt">Baz</span> <span class="ot">=</span> <span class="dt">Baz</span> {<span class="ot"> baz1 ::</span> <span class="dt">Int</span>,<span class="ot"> baz2 ::</span> <span class="dt">Double</span>,<span class="ot"> baz3 ::</span> <span class="dt">Text</span> }</span>
<span id="cb24-13"><a href="#cb24-13"></a></span>
<span id="cb24-14"><a href="#cb24-14"></a><span class="co">-- + Also good</span></span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="kw">data</span> <span class="dt">Foo</span></span>
<span id="cb24-16"><a href="#cb24-16"></a>    <span class="ot">=</span> <span class="dt">Bar</span> <span class="dt">Int</span> <span class="dt">Double</span></span>
<span id="cb24-17"><a href="#cb24-17"></a>    <span class="op">|</span> <span class="dt">Baz</span> <span class="dt">Int</span> <span class="dt">Double</span> <span class="dt">Text</span></span></code></pre></div>
<h3 id="strictness">Strictness<a href="#strictness" class="anchor">ðŸ”—</a></h3>
<p>Fields of data type constructors should be strict. Specify strictness explicitly with <code>!</code>. This helps to avoid space leaks and gives you an error instead of a warning in case you forget to initialize some fields.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb25-1"><a href="#cb25-1"></a><span class="co">-- + Good</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw">data</span> <span class="dt">Settings</span> <span class="ot">=</span> <span class="dt">Settings</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>    {<span class="ot"> settingsHasTravis  ::</span> <span class="op">!</span><span class="dt">Bool</span></span>
<span id="cb25-4"><a href="#cb25-4"></a>    ,<span class="ot"> settingsConfigPath ::</span> <span class="op">!</span><span class="dt">FilePath</span></span>
<span id="cb25-5"><a href="#cb25-5"></a>    ,<span class="ot"> settingsRetryCount ::</span> <span class="op">!</span><span class="dt">Int</span></span>
<span id="cb25-6"><a href="#cb25-6"></a>    }</span>
<span id="cb25-7"><a href="#cb25-7"></a></span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="co">-- - Bad</span></span>
<span id="cb25-9"><a href="#cb25-9"></a><span class="kw">data</span> <span class="dt">Settings</span> <span class="ot">=</span> <span class="dt">Settings</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>    {<span class="ot"> settingsHasTravis  ::</span> <span class="dt">Bool</span></span>
<span id="cb25-11"><a href="#cb25-11"></a>    ,<span class="ot"> settingsConfigPath ::</span> <span class="dt">FilePath</span></span>
<span id="cb25-12"><a href="#cb25-12"></a>    ,<span class="ot"> settingsRetryCount ::</span> <span class="dt">Int</span></span>
<span id="cb25-13"><a href="#cb25-13"></a>    }</span></code></pre></div>
<h3 id="deriving">Deriving<a href="#deriving" class="anchor">ðŸ”—</a></h3>
<p>Type classes in the deriving section should always be surrounded by parentheses. Donâ€™t derive typeclasses unnecessarily.</p>
<p>Use <a href="https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#deriving-strategies"><code>-XDerivingStrategies</code></a> extension for <code>newtype</code>s to explicitly specify the way you want to derive type classes:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb26-1"><a href="#cb26-1"></a><span class="ot">{-# LANGUAGE DeriveAnyClass             #-}</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="ot">{-# LANGUAGE DerivingStrategies         #-}</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="ot">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span></span>
<span id="cb26-4"><a href="#cb26-4"></a></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="kw">newtype</span> <span class="dt">Id</span> a <span class="ot">=</span> <span class="dt">Id</span> {<span class="ot"> unId ::</span> <span class="dt">Int</span> }</span>
<span id="cb26-6"><a href="#cb26-6"></a>    <span class="kw">deriving</span> stock    (<span class="dt">Generic</span>)</span>
<span id="cb26-7"><a href="#cb26-7"></a>    <span class="kw">deriving</span> <span class="kw">newtype</span>  (<span class="dt">Eq</span>, <span class="dt">Ord</span>, <span class="dt">Show</span>, <span class="dt">Hashable</span>)</span>
<span id="cb26-8"><a href="#cb26-8"></a>    <span class="kw">deriving</span> anyclass (<span class="dt">FromJSON</span>, <span class="dt">ToJSON</span>)</span></code></pre></div>
<h3 id="function-declaration">Function declaration<a href="#function-declaration" class="anchor">ðŸ”—</a></h3>
<p>All top-level functions <em>must</em> have type signatures.</p>
<p>All functions inside a <code>where</code> block <em>must</em> have type signatures. Explicit type signatures help to avoid cryptic type errors.</p>
<blockquote>
<p>You might need the <code>-XScopedTypeVariables</code> extension to write the polymorphic types of functions inside a <code>where</code> block.</p>
</blockquote>
<p>Surround <code>.</code> after <code>forall</code> in type signatures with spaces.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">lookup</span><span class="ot"> ::</span> <span class="kw">forall</span> a f <span class="op">.</span> <span class="dt">Typeable</span> a <span class="ot">=&gt;</span> <span class="dt">TypeRepMap</span> f <span class="ot">-&gt;</span> <span class="dt">Maybe</span> (f a)</span></code></pre></div>
<p>If the function type signature is very long, then place the type of each argument under its own line with respect to alignment.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb28-1"><a href="#cb28-1"></a>sendEmail</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="ot">    ::</span> <span class="kw">forall</span> env m <span class="op">.</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>       ( <span class="dt">MonadLog</span> m</span>
<span id="cb28-4"><a href="#cb28-4"></a>       , <span class="dt">MonadEmail</span> m</span>
<span id="cb28-5"><a href="#cb28-5"></a>       , <span class="dt">WithDb</span> env m</span>
<span id="cb28-6"><a href="#cb28-6"></a>       )</span>
<span id="cb28-7"><a href="#cb28-7"></a>    <span class="ot">=&gt;</span> <span class="dt">Email</span></span>
<span id="cb28-8"><a href="#cb28-8"></a>    <span class="ot">-&gt;</span> <span class="dt">Subject</span></span>
<span id="cb28-9"><a href="#cb28-9"></a>    <span class="ot">-&gt;</span> <span class="dt">Body</span></span>
<span id="cb28-10"><a href="#cb28-10"></a>    <span class="ot">-&gt;</span> <span class="dt">Template</span></span>
<span id="cb28-11"><a href="#cb28-11"></a>    <span class="ot">-&gt;</span> m ()</span></code></pre></div>
<p>If the line with argument names is too big, then put each argument on its own line and separate it somehow from the body section.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb29-1"><a href="#cb29-1"></a>sendEmail</span>
<span id="cb29-2"><a href="#cb29-2"></a>    toEmail</span>
<span id="cb29-3"><a href="#cb29-3"></a>    subject<span class="op">@</span>(<span class="dt">Subject</span> subj)</span>
<span id="cb29-4"><a href="#cb29-4"></a>    body</span>
<span id="cb29-5"><a href="#cb29-5"></a>    <span class="dt">Template</span>{<span class="op">..</span>}  <span class="co">-- default body variables</span></span>
<span id="cb29-6"><a href="#cb29-6"></a>  <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb29-7"><a href="#cb29-7"></a>    <span class="op">&lt;</span>code goes here<span class="op">&gt;</span></span></code></pre></div>
<p>In other cases, place an <code>=</code> sign on the same line where the function definition is.</p>
<p>Put operator fixity before operator signature:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb30-1"><a href="#cb30-1"></a><span class="co">-- | Flipped version of '&lt;$&gt;'.</span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="kw">infixl</span> <span class="dv">1</span> <span class="op">&lt;&amp;&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="ot">(&lt;&amp;&gt;) ::</span> <span class="dt">Functor</span> f <span class="ot">=&gt;</span> f a <span class="ot">-&gt;</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> f b</span>
<span id="cb30-4"><a href="#cb30-4"></a>as <span class="op">&lt;&amp;&gt;</span> f <span class="ot">=</span> f <span class="op">&lt;$&gt;</span> as</span></code></pre></div>
<p>Put pragmas immediately following the function they apply to.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb31-1"><a href="#cb31-1"></a><span class="co">-- | Lifted version of 'T.putStrLn'.</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="ot">putTextLn ::</span> <span class="dt">MonadIO</span> m <span class="ot">=&gt;</span> <span class="dt">Text</span> <span class="ot">-&gt;</span> m ()</span>
<span id="cb31-3"><a href="#cb31-3"></a>putTextLn <span class="ot">=</span> liftIO <span class="op">.</span> Text.putStrLn</span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="ot">{-# INLINE putTextLn #-}</span></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="ot">{-# SPECIALIZE putTextLn :: Text -&gt; IO () #-}</span></span></code></pre></div>
<p>In case of data type definitions, you must put the pragma before the type it applies to. Example:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">data</span> <span class="dt">TypeRepMap</span> (<span class="ot">f ::</span> k <span class="ot">-&gt;</span> <span class="dt">Type</span>) <span class="ot">=</span> <span class="dt">TypeRepMap</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>    {<span class="ot"> fingerprintAs ::</span> <span class="ot">{-# UNPACK #-}</span> <span class="op">!</span>(<span class="dt">PrimArray</span> <span class="dt">Word64</span>)</span>
<span id="cb32-3"><a href="#cb32-3"></a>    ,<span class="ot"> fingerprintBs ::</span> <span class="ot">{-# UNPACK #-}</span> <span class="op">!</span>(<span class="dt">PrimArray</span> <span class="dt">Word64</span>)</span>
<span id="cb32-4"><a href="#cb32-4"></a>    ,<span class="ot"> trAnys        ::</span> <span class="ot">{-# UNPACK #-}</span> <span class="op">!</span>(<span class="dt">Array</span> <span class="dt">Any</span>)</span>
<span id="cb32-5"><a href="#cb32-5"></a>    ,<span class="ot"> trKeys        ::</span> <span class="ot">{-# UNPACK #-}</span> <span class="op">!</span>(<span class="dt">Array</span> <span class="dt">Any</span>)</span>
<span id="cb32-6"><a href="#cb32-6"></a>    }</span></code></pre></div>
<h3 id="if-then-else-clauses">if-then-else clauses<a href="#if-then-else-clauses" class="anchor">ðŸ”—</a></h3>
<p>Prefer guards over <em>if-then-else</em> where possible.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb33-1"><a href="#cb33-1"></a><span class="co">-- + Good</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="ot">showParity ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>showParity n</span>
<span id="cb33-4"><a href="#cb33-4"></a>    <span class="op">|</span> <span class="fu">even</span> n    <span class="ot">=</span> <span class="st">&quot;even&quot;</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>    <span class="op">|</span> <span class="fu">otherwise</span> <span class="ot">=</span> <span class="st">&quot;odd&quot;</span></span>
<span id="cb33-6"><a href="#cb33-6"></a></span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="co">-- - Meh</span></span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="ot">showParity ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></span>
<span id="cb33-9"><a href="#cb33-9"></a>showParity n <span class="ot">=</span></span>
<span id="cb33-10"><a href="#cb33-10"></a>    <span class="kw">if</span> <span class="fu">even</span> n</span>
<span id="cb33-11"><a href="#cb33-11"></a>    <span class="kw">then</span> <span class="st">&quot;even&quot;</span></span>
<span id="cb33-12"><a href="#cb33-12"></a>    <span class="kw">else</span> <span class="st">&quot;odd&quot;</span></span></code></pre></div>
<p>When writing monadic code in <code>do</code>-blocks where guards cannot be used, add one indentation level before <code>then</code> and <code>else</code>:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb34-1"><a href="#cb34-1"></a>choose</span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="ot">    ::</span> <span class="dt">Text</span>  <span class="co">-- ^ Question text.</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>    <span class="ot">-&gt;</span> <span class="dt">NonEmpty</span> <span class="dt">Text</span>  <span class="co">-- ^ List of available options.</span></span>
<span id="cb34-4"><a href="#cb34-4"></a>    <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Text</span>  <span class="co">-- ^ The chosen option.</span></span>
<span id="cb34-5"><a href="#cb34-5"></a>choose question choices <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb34-6"><a href="#cb34-6"></a>    printQuestion question choices</span>
<span id="cb34-7"><a href="#cb34-7"></a>    answer <span class="ot">&lt;-</span> prompt</span>
<span id="cb34-8"><a href="#cb34-8"></a>    <span class="kw">if</span> <span class="fu">null</span> answer</span>
<span id="cb34-9"><a href="#cb34-9"></a>        <span class="kw">then</span> <span class="fu">pure</span> (<span class="fu">head</span> choices)</span>
<span id="cb34-10"><a href="#cb34-10"></a>        <span class="kw">else</span> <span class="fu">pure</span> answer</span></code></pre></div>
<p>In the code outside <code>do</code>-blocks you can align <em>if-then-else</em> clauses like you would normal expressions:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb35-1"><a href="#cb35-1"></a><span class="ot">shiftInts ::</span> [<span class="dt">Int</span>] <span class="ot">-&gt;</span> [<span class="dt">Int</span>]</span>
<span id="cb35-2"><a href="#cb35-2"></a>shiftInts <span class="ot">=</span> <span class="fu">map</span> <span class="op">$</span> \n <span class="ot">-&gt;</span> <span class="kw">if</span> <span class="fu">even</span> n <span class="kw">then</span> n <span class="op">+</span> <span class="dv">1</span> <span class="kw">else</span> n <span class="op">-</span> <span class="dv">1</span></span></code></pre></div>
<h3 id="case-expressions">Case expressions<a href="#case-expressions" class="anchor">ðŸ”—</a></h3>
<p>Align the <code>-&gt;</code> arrows in the alternatives when it helps readability.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb36-1"><a href="#cb36-1"></a><span class="co">-- + Good</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="ot">firstOrDefault ::</span> [a] <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a</span>
<span id="cb36-3"><a href="#cb36-3"></a>firstOrDefault list def <span class="ot">=</span> <span class="kw">case</span> list <span class="kw">of</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>    []  <span class="ot">-&gt;</span> def</span>
<span id="cb36-5"><a href="#cb36-5"></a>    x<span class="op">:</span>_ <span class="ot">-&gt;</span> x</span>
<span id="cb36-6"><a href="#cb36-6"></a></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="co">-- - Bad</span></span>
<span id="cb36-8"><a href="#cb36-8"></a><span class="ot">foo ::</span> <span class="dt">IO</span> ()</span>
<span id="cb36-9"><a href="#cb36-9"></a>foo <span class="ot">=</span> getArgs <span class="op">&gt;&gt;=</span> \<span class="kw">case</span></span>
<span id="cb36-10"><a href="#cb36-10"></a>    []                      <span class="ot">-&gt;</span> <span class="kw">do</span></span>
<span id="cb36-11"><a href="#cb36-11"></a>        <span class="fu">putStrLn</span> <span class="st">&quot;No arguments provided&quot;</span></span>
<span id="cb36-12"><a href="#cb36-12"></a>        runWithNoArgs</span>
<span id="cb36-13"><a href="#cb36-13"></a>    firstArg<span class="op">:</span>secondArg<span class="op">:</span>rest <span class="ot">-&gt;</span> <span class="kw">do</span></span>
<span id="cb36-14"><a href="#cb36-14"></a>        <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;The first argument is &quot;</span> <span class="op">++</span> firstArg</span>
<span id="cb36-15"><a href="#cb36-15"></a>        <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;The second argument is &quot;</span> <span class="op">++</span> secondArg</span>
<span id="cb36-16"><a href="#cb36-16"></a>    _                       <span class="ot">-&gt;</span> <span class="fu">pure</span> ()</span></code></pre></div>
<p>Use the <code>-XLambdaCase</code> extension when you perform pattern matching over the last argument of the function:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb37-1"><a href="#cb37-1"></a><span class="ot">fromMaybe ::</span> a <span class="ot">-&gt;</span> <span class="dt">Maybe</span> a <span class="ot">-&gt;</span> a</span>
<span id="cb37-2"><a href="#cb37-2"></a>fromMaybe v <span class="ot">=</span> \<span class="kw">case</span></span>
<span id="cb37-3"><a href="#cb37-3"></a>    <span class="dt">Nothing</span> <span class="ot">-&gt;</span> v</span>
<span id="cb37-4"><a href="#cb37-4"></a>    <span class="dt">Just</span> x  <span class="ot">-&gt;</span> x</span></code></pre></div>
<h3 id="let-expressions">let expressions<a href="#let-expressions" class="anchor">ðŸ”—</a></h3>
<p>Write every <code>let</code>-binding on a new line:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb38-1"><a href="#cb38-1"></a><span class="ot">isLimitedBy ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Natural</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>isLimitedBy n limit <span class="ot">=</span></span>
<span id="cb38-3"><a href="#cb38-3"></a>    <span class="kw">let</span> intLimit <span class="ot">=</span> <span class="fu">toInteger</span> limit</span>
<span id="cb38-4"><a href="#cb38-4"></a>    <span class="kw">in</span> n <span class="op">&lt;=</span> intLimit</span></code></pre></div>
<p>Put a <code>let</code> before each variable inside a <code>do</code> block. In pure functions try to avoid <code>let</code>. Instead, use <code>where</code>.</p>
<h2 id="general-recommendations">General recommendations<a href="#general-recommendations" class="anchor">ðŸ”—</a></h2>
<p>Try to split code into separate modules.</p>
<p>Avoid abusing point-free style. Sometimes code is clearer when <strong>not</strong> written in point-free style:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb39-1"><a href="#cb39-1"></a><span class="co">-- + Good</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="ot">foo ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Int</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>foo n x <span class="ot">=</span> <span class="fu">length</span> <span class="op">$</span> <span class="fu">replicate</span> n x</span>
<span id="cb39-4"><a href="#cb39-4"></a></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="co">-- - Bad</span></span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="ot">foo ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Int</span></span>
<span id="cb39-7"><a href="#cb39-7"></a>foo <span class="ot">=</span> (<span class="fu">length</span> <span class="op">.</span> ) <span class="op">.</span> <span class="fu">replicate</span></span></code></pre></div>
<p>Prefer <code>pure</code> over <code>return</code>.</p>
<p>Code should be compilable with the following ghc options without warnings:</p>
<ul>
<li><code>-Wall</code></li>
<li><code>-Wincomplete-uni-patterns</code></li>
<li><code>-Wincomplete-record-updates</code></li>
<li><code>-Wcompat</code></li>
<li><code>-Widentities</code></li>
<li><code>-Wredundant-constraints</code></li>
<li><code>-Wmissing-export-lists</code></li>
<li><code>-Wpartial-fields</code></li>
</ul>
<p>Enable <code>-fhide-source-paths</code> and <code>-freverse-errors</code> for cleaner compiler output.</p>
<p>Use <code>-XApplicativeDo</code> in combination with <code>-XRecordWildCards</code> to prevent position-sensitive errors where possible.</p>
              </p>
              </div>
          </div>
          </div>
      </div>


      <!-- Bootstrap core JavaScript -->
      <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"> </script>
      <script src="../js/post.js"> </script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/haskell.min.js"></script>
      <script>hljs.initHighlightingOnLoad()</script>
      <script async defer src="https://buttons.github.io/buttons.js"></script>
  </body>
</html>
